# RealHelpDesk API

**RealHelpDesk API** — это REST API для построения системы управления заявками или внутренней системы обработки запросов.

На данный момент реализован MVP (Minimum Viable Product):
- Регистрация, аутентификация, авторизация, верификация email пользователя.
- Создание порталов - точки в рамках которых формируется тематика заявок.
- Создание заявок в рамках портала.
- Создание сообщений в рамках заявки.
- Создатель портала может предоставить доступ к нему другому пользователю.
- Email-оповещения.

## Авторизация и безопасность

Используются JWT-токены для аутентификации и авторизации пользователей. Каждый входящий запрос проходит через фильтр `JwtAuthFilter`, который:
- Пропускает открытые эндпоинты (например, `/auth/login`) из белого списка.
- Извлекает access-токен из заголовка `Authorization: Bearer <token>`.
- Расшифровывает и проверяет access-токен с помощью `ValidTokenService`
- Устанавливает аутентификацию в `SecurityContextHolder`.
- Помечает ошибки токена (истёкший токен, некорректный формат и т.д.) через доп. заголовки.

## Структура проекта

- Core - конфигурация, глобальные исключения, фильтры, токены, пользователи.
- Domain - базовые entity, репозитории и сервисы.
- Feature - управление порталами, заявками, сообщениями, авторизацией и т.д.

## Запуск проекта

1. Поднять postgres: `help-utils/docker/docker-compose.postgres15.yml`
2. Поднять smtp4dev: `docker-compose.smtp4dev.yml`
3. `git clone https://github.com/dx9119/RealHelpDesk.git`
4. `source init.sh `
5. `init.sh` собирает проект (Maven), генерирует самоподписанный сертификат (`gen-selfsigned-keystore.sh`) и устанавливает переменные окружения (`setup-env-vars.sh`), используемые для конфигурации проекта.

## Логгирование (logback-spring.xml)

- `/log/realHelpDesk-**.log` запросы
- `/log/application-**.log` приложение

## Тестирование

- `postman_collection.json` - Коллекция для импорта в Postman.
- После регистрации вручную вставьте полученные `accessToken` и `refreshToken` в переменные окружения(Variables) Postman.

